{% load static %}
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% block title %}Shoe Inventory{% endblock %}</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">
  <link href="{% static 'css/admin.css' %}" rel="stylesheet">
</head>
<body>

<div class="app">
  <aside class="sidebar" id="sidebar">
    <div class="brand">
      <div class="brand-logo"><i class="bi bi-lightning-charge-fill"></i></div>
      <div class="brand-text">
        <div class="brand-title">KHUSSA MASTER</div>
        <div class="brand-sub">Management System</div>
      </div>
    </div>

    <nav class="nav flex-column mt-2">
      <a class="nav-link {% if request.path == '/' %}active{% endif %}" href="/">
        <i class="bi bi-speedometer2"></i><span>Dashboard</span>
      </a>

      <div class="nav-section">Sales</div>
      <a class="nav-link {% if '/invoice/new/' in request.path %}active{% endif %}" href="/invoice/new/">
        <i class="bi bi-receipt"></i><span>Start Sell</span>
      </a>
      <a class="nav-link {% if '/return/new/' in request.path %}active{% endif %}" href="/return/new/">
        <i class="bi bi-arrow-counterclockwise"></i><span>Return</span>
      </a>

      <div class="nav-section">Inventory</div>
      <a class="nav-link {% if '/stock/in/' in request.path %}active{% endif %}" href="/stock/in/">
        <i class="bi bi-box-seam"></i><span>Stock In</span>
      </a>
      <a class="nav-link {% if '/products/' in request.path %}active{% endif %}" href="/products/">
        <i class="bi bi-tags"></i><span>Products</span>
      </a>

      <div class="nav-section">Admin UI</div>
      <a class="nav-link {% if '/admin-ui/' in request.path %}active{% endif %}" href="/admin-ui/">
        <i class="bi bi-grid-1x2"></i><span>Admin Panel</span>
      </a>
      <!-- <a class="nav-link" href="/admin/">
        <i class="bi bi-shield-lock"></i><span>Django Admin</span>
      </a> -->

      <div class="nav-section">Reports</div>
      <a class="nav-link {% if '/reports/' in request.path %}active{% endif %}" href="/reports/">
        <i class="bi bi-bar-chart"></i><span>Reports</span>
      </a>
    </nav>

    <div class="sidebar-footer">
      <div class="small text-muted">Logged in as</div>
      <div class="fw-semibold">
        {% if request.user.is_authenticated %}{{ request.user.username }}{% else %}Guest{% endif %}
      </div>
    </div>
  </aside>

  <main class="main">
    <header class="topbar">
      <button class="btn btn-icon" id="btnToggle" type="button" aria-label="Toggle sidebar">
        <i class="bi bi-list"></i>
      </button>

      <div class="topbar-title">{% block page_title %}Dashboard{% endblock %}</div>

      <div class="topbar-actions">
        <div class="topbar-pill">
          <i class="bi bi-clock"></i>
          <span id="nowClock">â€”</span>
        </div>

        <div class="dropdown">
          <button class="btn btn-light btn-sm dropdown-toggle" data-bs-toggle="dropdown">
            <i class="bi bi-person-circle me-1"></i>
            {% if request.user.is_authenticated %}{{ request.user.username }}{% else %}Guest{% endif %}
          </button>
          <ul class="dropdown-menu dropdown-menu-end">
            <li><a class="dropdown-item" href="/admin-ui/">Custom Admin UI</a></li>
            <!-- <li><a class="dropdown-item" href="/admin/">Django Admin</a></li> -->
          </ul>
        </div>
      </div>
    </header>

    <section class="content">
      {% if messages %}
        <div class="mb-3">
          {% for message in messages %}
            <div class="alert alert-{{ message.tags }} mb-2">{{ message }}</div>
          {% endfor %}
        </div>
      {% endif %}

      {% block content %}{% endblock %}
    </section>
  </main>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
  (function(){
    const btn = document.getElementById("btnToggle");
    btn?.addEventListener("click", () => {
      document.body.classList.toggle("sidebar-collapsed");
    });

    const el = document.getElementById("nowClock");
    function tick(){
      const d = new Date();
      if(el) el.textContent = d.toLocaleString();
    }
    tick(); setInterval(tick, 1000);
  })();
</script>

</body>
</html>
